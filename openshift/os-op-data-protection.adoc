---
sidebar: sidebar 
permalink: openshift/os-op-data-protection.html 
keywords: NetApp Solutions, redhat OpenShift, red hat OpenShift, redhat openshift container platform, ocp, openshift container platform, Advanced Cluster Management, ACM, Hub Cluster, containers, container workloads, VMware, customer managed storage, ONTAP 
summary:  
---
= 使用Astra進行資料保護
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
此頁面顯示了使用Trident Protect (ACC) 在 VMware vSphere 上運行的基於 Red Hat OpenShift Container 的應用程式的資料保護選項。

當使用者使用 Red Hat OpenShift 對其應用程式進行現代化改造時，應該制定資料保護策略來保護它們免受意外刪除或任何其他人為錯誤的影響。通常，出於監管或合規目的，還需要製定保護策略來保護其資料免受災難。

資料保護的要求多種多樣，從恢復到某個時間點的副本到無需任何人工幹預即可自動故障轉移到不同的故障域。許多客戶選擇ONTAP作為其 Kubernetes 應用程式的首選儲存平台，因為它具有豐富的功能，例如多租戶、多協定、高效能和容量產品、多站點位置的複製和快取、安全性和靈活性。

ONTAP中的資料保護可以透過臨時或政策控制來實現 - **快照** - **備份和還原**

Snapshot 副本和備份均可保護以下類型的資料： - **代表應用程式狀態的應用程式元資料** - **與應用程式關聯的任何持久性資料磁碟區** - **屬於應用程式的任何資源工件**



== 使用 ACC 拍攝快照

可以使用帶有 ACC 的快照捕獲資料的時間點副本。保護策略定義要保留的 Snapshot 副本的數量。可用的最小計劃選項是每小時。可以隨時手動、按需進行 Snapshot 副本，間隔比計劃的 Snapshot 副本更短。快照副本與應用程式儲存在相同的配置磁碟區上。



=== 使用 ACC 設定快照

image:rhhc-onprem-dp-snap.png["Trident Protect 快照視圖"]



== 使用 ACC 備份和恢復

備份基於快照。 Trident Protect 可使用 CSI 取得 Snapshot 副本，並使用時間點 Snapshot 副本執行備份。備份儲存在外部物件儲存中（任何與 S3 相容的存儲，包括位於不同位置的ONTAP S3）。可以為排程備份和要保留的備份版本數量配置保護策略。最小 RPO 為一小時。



=== 使用 ACC 從備份還原應用程式

ACC 從儲存備份的 S3 儲存桶恢復應用程式。

image:rhhc-onprem-dp-br.png["Trident Protect 復原選項"]



== 應用程式特定的執行鉤子

此外，可以配置執行掛鉤以與託管應用程式的資料保護操作一起運行。即使儲存陣列級資料保護功能可用，通常仍需要採取額外步驟來確保備份和復原以及應用程式的一致性。特定於應用程式的附加步驟可以是： - 在建立 Snapshot 副本之前或之後。  - 在建立備份之前或之後。  - 從 Snapshot 副本或備份還原後。

Astra Control 可以執行這些特定於應用程式的步驟，這些步驟被編碼為稱為執行掛鉤的自訂腳本。

https://github.com/NetApp/Verda["NetApp Verda GitHub 項目"]為流行的雲端原生應用程式提供執行掛鉤，使保護應用程式變得簡單、強大且易於協調。如果您擁有存儲庫中沒有的應用程式的足夠信息，請隨意為該專案做出貢獻。



== Redis 應用程式預快照的範例執行掛鉤。

image:rhhc-onprem-dp-br-hook.png["Trident Protect 執行鉤子"]



== 使用 ACC 進行複製

對於區域保護或低 RPO 和 RTO 解決方案，可以將應用程式複製到在不同網站（最好是在另一個區域）運行的另一個 Kubernetes 實例。 Trident Protect 採用ONTAP非同步SnapMirror ，RPO 低至 5 分鐘。複製是透過複製到ONTAP來完成的，然後故障轉移會在目標叢集中建立 Kubernetes 資源。


NOTE: 請注意，複製不同於備份和恢復，備份和恢復是將備份轉移到 S3，然後從 S3 執行恢復。請參閱連結： https://docs.netapp.com/us-en/astra-control-center/concepts/data-protection.html#replication-to-a-remote-cluster ://docs.netapp.com/us-en/astra-control-center/concepts/data-protection.html#replication-to-a-remote-cluster [此處] 以取得有關兩種資料保護類型的差異的更多詳細資訊。

參考link:https://docs.netapp.com/us-en/astra-control-center/use/replicate_snapmirror.html["這裡"]有關SnapMirror設定說明。



=== 帶有 ACC 的SnapMirror

image:rhhc-onprem-dp-rep.png["Trident Protect 複製"]


NOTE: san-economy 和 nas-economy 儲存驅動程式不支援複製功能。參考link:https://docs.netapp.com/us-en/astra-control-center/get-started/requirements.html#astra-trident-requirements["這裡"]了解更多詳細資訊。



=== 示範影片：

link:https://www.netapp.tv/details/29504?mcid=35609780286441704190790628065560989458["Trident Protect 災難復原示範影片"]

.使用Trident Protect 進行資料保護
video::0cec0c90-4c6f-4018-9e4f-b09700eefb3a[panopto,width=360]


== 利用MetroCluster實現業務連續性

我們的大多數ONTAP硬體平台都具有高可用性功能，可防止設備故障，避免執行災難復原。但為了防止火災或任何其他災難，並以零 RPO 和低 RTO 繼續開展業務，通常會使用MetroCluster解決方案。

目前擁有ONTAP系統的客戶可以透過在距離限制內添加支援的ONTAP系統來擴展到MetroCluster ，以提供區域級災難復原。 Trident，CSI（容器儲存介面）支援NetApp ONTAP，ONTAPMetroCluster配置以及其他選項，如Cloud Volumes ONTAP、 Azure NetApp Files、AWS FSx ONTAP等。 Trident 為Trident提供了五種儲存驅動程式選項，並且所有選項都支援MetroCluster配置。參考link:https://docs.netapp.com/us-en/trident/trident-use/backends.html["這裡"]有關Trident支援的ONTAP儲存驅動程式的更多詳細資訊。

MetroCluster解決方案需要第 2 層網路擴展或從兩個故障域存取相同網路位址的能力。一旦MetroCluster配置到位，該解決方案對於應用程式擁有者來說是透明的，因為MetroCluster svm 中的所有磁碟區都受到保護並獲得SyncMirror （零 RPO）的好處。

image:rhhc-onprem-dp-bc.png["採用MetroCluster 的業務連續性解決方案"]


TIP: 對於Trident後端設定 (TBC)，使用MetroCluster設定時請勿指定 dataLIF 和 SVM。為 managementLIF 指定 SVM 管理 IP 並使用 vsadmin 角色憑證。

有關Trident Protect 資料保護功能的詳細信息link:https://docs.netapp.com/us-en/astra-control-center/concepts/data-protection.html["這裡"]
