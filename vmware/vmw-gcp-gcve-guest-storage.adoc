---
sidebar: sidebar 
permalink: vmware/vmw-gcp-gcve-guest-storage.html 
keywords: NetApp Solutions, google cloud, gcp, gcve, enterprise, hybrid, cloud, cloud volumes ontap, cvo 
summary:  
---
= 適用於 GCP 的NetApp儲存選項
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
GCP 支援透過Cloud Volumes ONTAP (CVO) 或Google Cloud NetApp Volumes (NetApp Volumes) 連接來賓的NetApp儲存。



== Cloud Volumes ONTAP (CVO)

Cloud Volumes ONTAP（或稱 CVO）是基於 NetApp 的ONTAP儲存軟體所建置的業界領先的雲端資料管理解決方案，可在 Amazon Web Services (AWS)、Microsoft Azure 和 Google Cloud Platform (GCP) 上原生使用。

它是ONTAP的軟體定義版本，使用雲端原生存儲，允許您在雲端和本地使用相同的存儲軟體，從而無需重新培訓 IT 人員採用全新方法來管理資料。

CVO 使客戶能夠無縫地將資料從邊緣移動到資料中心、雲端並返回，從而將您的混合雲整合在一起 - 所有這些都透過單一窗格管理控制台NetApp Cloud Manager 進行管理。

CVO 的設計旨在提供極致的效能和先進的資料管理功能，以滿足您在雲端最嚴苛的應用程式



=== Cloud Volumes ONTAP (CVO) 作為來賓連接存儲

.在 Google Cloud 中部署Cloud Volumes ONTAP （自行部署）
[%collapsible%open]
====
可從在 GCVE 私有雲環境中建立的虛擬機器掛載Cloud Volumes ONTAP共用和 LUN。這些磁碟區還可以安裝在 Linux 用戶端和 Windows 用戶端上，並且當透過 iSCSI 安裝時，可以在 Linux 或 Windows 用戶端上將 LUNS 作為區塊裝置進行訪問，因為Cloud Volumes ONTAP支援 iSCSI、SMB 和 NFS 協定。只需幾個簡單的步驟即可設定Cloud Volumes ONTAP磁碟區。

若要將磁碟區從本機環境複製到雲端以用於災難復原或遷移，請使用網站到網站 VPN 或 Cloud Interconnect 建立與 Google Cloud 的網路連線。將資料從本地複製到Cloud Volumes ONTAP超出了本文檔的範圍。若要在本機和Cloud Volumes ONTAP系統之間複製數據，請參閱link:mailto:CloudOwner@gve.local#setting-up-data-replication-between-systems["設定係統之間的資料複製"]。


NOTE: 使用link:https://cloud.netapp.com/cvo-sizer["Cloud Volumes ONTAP大小調整器"]準確地確定Cloud Volumes ONTAP實例的大小。也可以監控本機效能以用作Cloud Volumes ONTAP大小調整器的輸入。

. 登入NetApp Cloud Central — 顯示 Fabric View 畫面。找到Cloud Volumes ONTAP標籤並選擇前往雲端管理員。登入後，將顯示 Canvas 畫面。
+
image:gcve-cvo-guest-001.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 在 Cloud Manager Canvas 標籤上，按一下新增工作環境，然後選擇 Google Cloud Platform 作為雲端和系統配置類型。然後按一下“下一步”。
+
image:gcve-cvo-guest-002.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 提供要建立的環境的詳細信息，包括環境名稱和管理員憑證。完成後，按一下“繼續”。
+
image:gcve-cvo-guest-003.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 選擇或取消選擇Cloud Volumes ONTAP部署的附加服務，包括資料感知與合規性或備份到雲端。然後，點擊“繼續”。
+
提示：停用附加服務時將顯示驗證彈出訊息。  CVO 部署後可以新增/刪除附加服務，如果從一開始就不需要，請考慮取消選擇它們以避免成本。

+
image:gcve-cvo-guest-004.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 選擇一個位置，選擇防火牆策略，然後選取核取方塊以確認與 Google Cloud 儲存的網路連線。
+
image:gcve-cvo-guest-005.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 選擇授權選項：按使用量付費或使用現有授權的 BYOL。在此範例中，使用了免費增值選項。然後，點擊繼續。
+
image:gcve-cvo-guest-006.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 根據將在 AWS SDDC 上的 VMware 雲端上執行的虛擬機器上部署的工作負載類型，在幾個可用的預先配置套件中進行選擇。
+
提示：將滑鼠懸停在圖塊上以查看詳細信息，或按一下「更改配置」自訂 CVO 組件和ONTAP版本。

+
image:gcve-cvo-guest-007.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 在「審核並批准」頁面上，審核並確認選擇。若要建立Cloud Volumes ONTAP實例，請按一下「開始」。
+
image:gcve-cvo-guest-008.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 配置Cloud Volumes ONTAP後，它會列在 Canvas 頁面上的工作環境中。
+
image:gcve-cvo-guest-009.png["此圖顯示輸入/輸出對話框或表示書面內容"]



====
.SMB 磁碟區的附加配置
[%collapsible%open]
====
. 工作環境準備好後，請確保 CIFS 伺服器配置了適當的 DNS 和 Active Directory 設定參數。在建立 SMB 磁碟區之前，需要執行此步驟。
+
提示：按一下選單圖示 (º)，選擇進階以顯示更多選項並選擇 CIFS 設定。

+
image:gcve-cvo-guest-010.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 建立 SMB 磁碟區是一個簡單的過程。在 Canvas 中，雙擊Cloud Volumes ONTAP工作環境來建立和管理卷，然後按一下建立卷選項。選擇適當的大小，雲端管理器選擇包含的聚合或使用進階分配機制放置在特定的聚合上。對於此演示，選擇 CIFS/SMB 作為協定。
+
image:gcve-cvo-guest-011.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 磁碟區配置完成後，它將在「磁碟區」窗格下可用。由於已配置 CIFS 共享，請授予您的使用者或群組對檔案和資料夾的權限，並驗證這些使用者是否可以存取共用並建立檔案。如果從本機環境複製卷，則不需要此步驟，因為檔案和資料夾權限都將作為SnapMirror複製的一部分保留。
+
提示：按一下音量選單 (º) 以顯示其選項。

+
image:gcve-cvo-guest-012.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 建立磁碟區後，使用 mount 指令顯示磁碟區連線說明，然後從 Google Cloud VMware Engine 上的虛擬機器連線到共用。
+
image:gcve-cvo-guest-013.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 複製以下路徑並使用映射網路磁碟機選項將磁碟區掛載到在 Google Cloud VMware Engine 上執行的虛擬機器上。
+
image:gcve-cvo-guest-014.png["此圖顯示輸入/輸出對話框或表示書面內容"]

+
一旦映射，就可以輕鬆訪問，並且可以相應地設定 NTFS 權限。

+
image:gcve-cvo-guest-015.png["此圖顯示輸入/輸出對話框或表示書面內容"]



====
.Cloud Volumes ONTAP上的 LUN 連接到主機
[%collapsible%open]
====
若要將雲端磁碟區ONTAP LUN 連接到主機，請完成下列步驟：

. 在「畫布」頁面上，雙擊Cloud Volumes ONTAP工作環境以建立和管理磁碟區。
. 按一下新增磁碟區 > 新磁碟區並選擇 iSCSI，然後按一下建立啟動器群組。按一下「Continue（繼續）」。
+
image:gcve-cvo-guest-016.png["此圖顯示輸入/輸出對話框或表示書面內容"] image:gcve-cvo-guest-017.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 配置磁碟區後，選擇磁碟區選單 (º)，然後按一下目標 iQN。若要複製 iSCSI 限定名稱 (iQN)，請按一下複製。建立從主機到 LUN 的 iSCSI 連線。


若要對駐留在 Google Cloud VMware Engine 上的主機完成相同操作：

. 透過 RDP 連接到託管在 Google Cloud VMware Engine 上的虛擬機器。
. 開啟 iSCSI 發起程式屬性對話方塊：伺服器管理員 > 儀表板 > 工具 > iSCSI 發起程式。
. 在“發現”標籤中，按一下“發現入口網站”或“新增入口網站”，然後輸入 iSCSI 目標連接埠的 IP 位址。
. 從「目標」標籤中，選擇發現的目標，然後按一下「登入」或「連線」。
. 選擇啟用多路徑，然後選擇電腦啟動時自動恢復此連線或將此連線新增至收藏目標清單。按一下“進階”。
+

NOTE: Windows 主機必須與群集中的每個節點建立 iSCSI 連線。本機 DSM 選擇要使用的最佳路徑。

+
image:gcve-cvo-guest-018.png["此圖顯示輸入/輸出對話框或表示書面內容"]

+
儲存虛擬機器 (SVM) 上的 LUN 對於 Windows 主機來說顯示為磁碟。主機不會自動發現任何新新增的磁碟。透過完成以下步驟觸發手動重新掃描以發現磁碟：

+
.. 開啟 Windows 電腦管理公用程式：開始 > 管理工具 > 電腦管理。
.. 在導航樹中展開儲存節點。
.. 按一下“磁碟管理”。
.. 按一下操作 > 重新掃描磁碟。
+
image:gcve-cvo-guest-019.png["此圖顯示輸入/輸出對話框或表示書面內容"]

+
當 Windows 主機首次存取新的 LUN 時，它沒有分割區或檔案系統。初始化 LUN；並且（可選）透過完成以下步驟使用檔案系統格式化 LUN：

.. 啟動 Windows 磁碟管理。
.. 右鍵單擊 LUN，然後選擇所需的磁碟或分割區類型。
.. 請按照精靈中的說明進行操作。在此範例中，已安裝磁碟機 F:。




image:gcve-cvo-guest-020.png["此圖顯示輸入/輸出對話框或表示書面內容"]

在 Linux 用戶端上，確保 iSCSI 守護程序正在執行。配置 LUN 後，請參閱此處以 Ubuntu 為例的 iSCSI 設定詳細指南。要驗證，請從 shell 運行 lsblk cmd。

image:gcve-cvo-guest-021.png["此圖顯示輸入/輸出對話框或表示書面內容"] image:gcve-cvo-guest-022.png["此圖顯示輸入/輸出對話框或表示書面內容"]

====
.在 Linux 用戶端上掛載Cloud Volumes ONTAP NFS 卷
[%collapsible%open]
====
若要從 Google Cloud VMware Engine 中的虛擬機器掛載Cloud Volumes ONTAP (DIY) 檔案系統，請依照下列步驟操作：

請依照下列步驟配置磁碟區

. 在磁碟區選項卡中，按一下建立新磁碟區。
. 在「建立新磁碟區」頁面上，選擇磁碟區類型：
+
image:gcve-cvo-guest-023.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 在「磁碟區」標籤中，將滑鼠遊標放在磁碟區上，選擇選單圖示 (º)，然後按一下「掛載指令」。
+
image:gcve-cvo-guest-024.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 按一下“複製”。
. 連接到指定的Linux實例。
. 使用安全殼 (SSH) 在執行個體上開啟終端並使用適當的憑證登入。
. 使用下列指令為磁碟區的掛載點建立目錄。
+
 $ sudo mkdir /cvogcvetst
+
image:gcve-cvo-guest-025.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 將Cloud Volumes ONTAP NFS 磁碟區掛載到上一個步驟所建立的目錄。
+
 sudo mount 10.0.6.251:/cvogcvenfsvol01 /cvogcvetst
+
image:gcve-cvo-guest-026.png["此圖顯示輸入/輸出對話框或表示書面內容"] image:gcve-cvo-guest-027.png["此圖顯示輸入/輸出對話框或表示書面內容"]



====


== Google Cloud NetApp Volumes(NetApp區)

Google Cloud NetApp Volumes （NetApp Volumes）是一套完整的資料服務組合，可提供先進的雲端解決方案。  NetApp Volumes 支援主要雲端供應商的多種文件存取協定（NFS 和 SMB 支援）。

其他優點和功能包括：使用快照進行資料保護和復原；在本地或雲端複製、同步和遷移資料目的地的特殊功能；以及在專用快閃記憶體系統層級保持一致的高效能。



=== Google Cloud NetApp Volumes （NetApp Volumes）作為來賓連接存儲

.使用 VMware Engine 設定NetApp區
[%collapsible%open]
====
可從在 VMware Engine 環境中建立的虛擬機器掛載Google Cloud NetApp Volumes共用。由於Google Cloud NetApp Volumes支援 SMB 和 NFS 協議，因此這些磁碟區也可以安裝在 Linux 用戶端上並對應到 Windows 用戶端上。可以透過簡單的步驟來設定Google Cloud NetApp Volumes磁碟區。

Google Cloud NetApp Volumes和 Google Cloud VMware Engine 私有雲必須位於同一區域。

若要從 Google Cloud Marketplace 購買、啟用和設定適用於 Google Cloud 的 Google Google Cloud NetApp Volumes ，請依照以下詳細說明操作link:https://cloud.google.com/vmware-engine/docs/quickstart-prerequisites["指導"]。

====
.建立NetApp Volumes NFS 捲到 GCVE 私有雲
[%collapsible%open]
====
若要建立和掛載 NFS 卷，請完成下列步驟：

. 從 Google 雲端控制台中的合作夥伴解決方案存取 Cloud Volumes。
+
image:gcve-cvs-guest-001.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 在 Cloud Volumes 控制台中，前往磁碟區頁面並按一下建立。
+
image:gcve-cvs-guest-002.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 在建立檔案系統頁面上，根據退款機制的需要指定磁碟區名稱和計費標籤。
+
image:gcve-cvs-guest-003.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 選擇適當的服務。對於 GCVE，根據應用程式工作負載要求選擇NetApp Volumes-Performance 和所需的服務級別，以改善延遲並提高效能。
+
image:gcve-cvs-guest-004.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 指定磁碟區和磁碟區路徑的 Google Cloud 區域（磁碟區路徑在專案的所有雲端磁碟區中必須是唯一的）
+
image:gcve-cvs-guest-005.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 選擇磁碟區的效能等級。
+
image:gcve-cvs-guest-006.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 指定磁碟區的大小和協定類型。本次測試採用的是NFSv3。
+
image:gcve-cvs-guest-007.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 在此步驟中，選擇可存取磁碟區的 VPC 網路。確保 VPC 對等連接已到位。
+
提示：如果尚未完成 VPC 對等連接，則會顯示一個彈出按鈕來引導您完成對等連接命令。開啟 Cloud Shell 會話並執行適當的命令以將您的 VPC 與Google Cloud NetApp Volumes生產者對等連接。如果您決定提前準備 VPC 對等連接，請參閱這些說明。

+
image:gcve-cvs-guest-008.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 透過新增適當的規則來管理匯出策略規則並選取對應 NFS 版本的核取方塊。
+
注意：除非新增匯出策略，否則無法存取 NFS 磁碟區。

+
image:gcve-cvs-guest-009.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 按一下「儲存」以建立磁碟區。
+
image:gcve-cvs-guest-010.png["此圖顯示輸入/輸出對話框或表示書面內容"]



====
.將 NFS 匯出掛載到在 VMware Engine 上執行的虛擬機
[%collapsible%open]
====
在準備掛載 NFS 磁碟區之前，請確保私有連線的對等狀態列為「活動」。一旦狀態為“活動”，請使用 mount 指令。

若要掛載 NFS 卷，請執行下列操作：

. 在 Cloud Console 中，前往 Cloud Volumes > Volumes。
. 前往卷頁面
. 按一下要掛載 NFS 匯出的 NFS 磁碟區。
. 捲動到右側，在“顯示更多”下按一下“安裝說明”。


若要從 VMware VM 的客戶作業系統執行安裝流程，請依照下列步驟操作：

. 使用 SSH 用戶端並透過 SSH 連接到虛擬機器。
. 在實例上安裝 nfs 用戶端。
+
.. 在 Red Hat Enterprise Linux 或 SuSE Linux 實例上：
+
 sudo yum install -y nfs-utils
.. 在 Ubuntu 或 Debian 實例上：
+
 sudo apt-get install nfs-common


. 在實例上建立一個新目錄，例如“/nimCVSNFSol01”：
+
 sudo mkdir /nimCVSNFSol01
+
image:gcve-cvs-guest-020.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 使用適當的命令掛載卷。實驗室的範例命令如下：
+
 sudo mount -t nfs -o rw,hard,rsize=65536,wsize=65536,vers=3,tcp 10.53.0.4:/nimCVSNFSol01 /nimCVSNFSol01
+
image:gcve-cvs-guest-021.png["此圖顯示輸入/輸出對話框或表示書面內容"] image:gcve-cvs-guest-022.png["此圖顯示輸入/輸出對話框或表示書面內容"]



====
.建立 SMB 共用並將其掛載到在 VMware Engine 上執行的虛擬機
[%collapsible%open]
====
對於 SMB 卷，請確保在建立 SMB 磁碟區之前已設定了 Active Directory 連線。

image:gcve-cvs-guest-030.png["此圖顯示輸入/輸出對話框或表示書面內容"]

一旦 AD 連接到位，即可建立具有所需服務等級的磁碟區。除了選擇適當的協定外，步驟與建立 NFS 磁碟區類似。

. 在 Cloud Volumes 控制台中，前往磁碟區頁面並按一下建立。
. 在建立檔案系統頁面上，根據退款機制的需要指定磁碟區名稱和計費標籤。
+
image:gcve-cvs-guest-031.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 選擇適當的服務。對於 GCVE，根據工作負載要求選擇NetApp Volumes-Performance 和所需的服務級別，以改善延遲並提高效能。
+
image:gcve-cvs-guest-032.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 指定磁碟區和磁碟區路徑的 Google Cloud 區域（磁碟區路徑在專案的所有雲端磁碟區中必須是唯一的）
+
image:gcve-cvs-guest-033.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 選擇磁碟區的效能等級。
+
image:gcve-cvs-guest-034.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 指定磁碟區的大小和協定類型。本次測試中使用了 SMB。
+
image:gcve-cvs-guest-035.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 在此步驟中，選擇可存取磁碟區的 VPC 網路。確保 VPC 對等連接已到位。
+
提示：如果尚未完成 VPC 對等連接，則會顯示一個彈出按鈕來引導您完成對等連接命令。開啟 Cloud Shell 會話並執行適當的命令以將您的 VPC 與Google Cloud NetApp Volumes生產者對等連接。如果您決定提前準備 VPC 對等連接，請參閱這些link:https://cloud.google.com/architecture/partners/netapp-cloud-volumes/setting-up-private-services-access?hl=en["指示"]。

+
image:gcve-cvs-guest-036.png["此圖顯示輸入/輸出對話框或表示書面內容"]

. 按一下「儲存」以建立磁碟區。
+
image:gcve-cvs-guest-037.png["此圖顯示輸入/輸出對話框或表示書面內容"]



若要安裝 SMB 卷，請執行以下操作：

. 在 Cloud Console 中，前往 Cloud Volumes > Volumes。
. 前往卷頁面
. 按一下要對應 SMB 共享的 SMB 磁碟區。
. 捲動到右側，在“顯示更多”下按一下“安裝說明”。


若要從 VMware VM 的 Windows 用戶作業系統執行安裝流程，請依照下列步驟操作：

. 按一下“開始”按鈕，然後按一下“電腦”。
. 按一下「映射網路磁碟機」。
. 在磁碟機清單中，按一下任何可用的磁碟機號。
. 在資料夾框中，鍵入：
+
 \\nimsmb-3830.nimgcveval.com\nimCVSMBvol01
+
image:gcve-cvs-guest-038.png["此圖顯示輸入/輸出對話框或表示書面內容"]

+
若要在每次登入電腦時進行連接，請勾選「登入時重新連接」複選框。

. 按一下“完成”。
+
image:gcve-cvs-guest-039.png["此圖顯示輸入/輸出對話框或表示書面內容"]



====